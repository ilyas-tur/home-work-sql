--  Задача 1: Создайте базу данных bookstore_db
CREATE DATABASE bookstore_db;

-- Задача 2: Создайте таблицу books со всеми полями NOT NULL и ограничением для цены
CREATE TABLE books (
    id SERIAL PRIMARY KEY,
    title VARCHAR(100) NOT NULL,
    author VARCHAR(100) NOT NULL,
    price DECIMAL(10,2) NOT NULL CHECK (price > 0),
    genre VARCHAR(100) NOT NULL,
    publication_year INT NOT NULL
);

-- Задача 3: Добавьте 40 книг в таблицу books
INSERT INTO books (title, author, price, genre, publication_year) VALUES
('1984', 'Джордж Оруэлл', 2500.00, 'Дистопия', 1949),
('Гарри Поттер и философский камень', 'Джоан Роулинг', 3000.00, 'Фэнтези', 1997),
('Гарри Поттер и тайная комната', 'Джоан Роулинг', 3200.00, 'Фэнтези', 1998),
('Алиса в стране чудес', 'Льюис Кэрролл', 2700.00, 'Фэнтези', 1865),
('Человек-невидимка', 'Герберт Уэллс', 2900.00, 'Фантастика', 1897),
('Дракула', 'Брэм Стокер', 3100.00, 'Ужасы', 1897),
('Фауст', 'Иоганн Гёте', 4300.00, 'Трагедия', 1808),
('Маленький принц', 'Антуан де Сент-Экзюпери', 2200.00, 'Сказка', 1943),
('Дон Кихот', 'Мигель де Сервантес', 4800.00, 'Роман', 1605),
('Гордость и предубеждение', 'Джейн Остин', 3100.00, 'Роман', 1813),
('451 градус по Фаренгейту', 'Рэй Брэдбери', 3500.00, 'Дистопия', 1953),
('Граф Монте-Кристо', 'Александр Дюма', 4000.00, 'Приключения', 1844),
('Три мушкетера', 'Александр Дюма', 3800.00, 'Приключения', 1844),
('Зов Ктулху', 'Говард Лавкрафт', 2800.00, 'Ужасы', 1928),
('Хоббит', 'Джон Р. Р. Толкин', 3300.00, 'Фэнтези', 1937),
('Властелин колец', 'Джон Р. Р. Толкин', 5200.00, 'Фэнтези', 1954),
('Айвенго', 'Вальтер Скотт', 3600.00, 'Исторический роман', 1819),
('Метро 2033', 'Дмитрий Глуховский', 3700.00, 'Фантастика', 2005),
('Сияние', 'Стивен Кинг', 3900.00, 'Ужасы', 1977),
('Оно', 'Стивен Кинг', 4400.00, 'Ужасы', 1986),
('Код да Винчи', 'Дэн Браун', 3000.00, 'Детектив', 2003),
('Шерлок Холмс: Собрание рассказов', 'Артур Конан Дойл', 4200.00, 'Детектив', 1892),
('Портрет Дориана Грея', 'Оскар Уайльд', 3100.00, 'Роман', 1890),
('Старик и море', 'Эрнест Хемингуэй', 2700.00, 'Роман', 1952),
('Мартин Иден', 'Джек Лондон', 3500.00, 'Роман', 1909),
('Князь', 'Никколо Макиавелли', 2900.00, 'Политика', 1513),
('Гарри Поттер и узник Азкабана', 'Джоан Роулинг', 3400.00, 'Фэнтези', 1999),
('Гарри Поттер и Кубок огня', 'Джоан Роулинг', 3600.00, 'Фэнтези', 2000),
('Хроники Нарнии: Лев, колдунья и платяной шкаф', 'Клайв Льюис', 2800.00, 'Фэнтези', 1950),
('Моби Дик', 'Герман Мелвилл', 4500.00, 'Роман', 1851),
('Гарри Поттер и Орден Феникса', 'Джоан Роулинг', 3800.00, 'Фэнтези', 2003),
('Жажда жизни', 'Ирвинг Стоун', 3100.00, 'Биография', 1934),
('Джейн Эйр', 'Шарлотта Бронте', 2900.00, 'Роман', 1847),
('Замок Броуди', 'Арчибальд Кронин', 3200.00, 'Драма', 1938),
('Тёмные начала', 'Филип Пулман', 3900.00, 'Фэнтези', 1995),
('Машина времени', 'Герберт Уэллс', 2800.00, 'Фантастика', 1895),
('Игра Эндера', 'Орсон Скотт Кард', 3500.00, 'Фантастика', 1985),
('Дюна', 'Фрэнк Герберт', 4500.00, 'Фантастика', 1965);

-- Задача 4: Выведите названия и авторов всех книг
SELECT title, author FROM books;

-- Задача 5: Найдите все книги, дороже 3500
SELECT * FROM books WHERE price > 3500;

-- Задача 6: Найдите все книги, которые были опубликованы после 1950 года
SELECT * FROM books WHERE publication_year > 1950;

-- Задача 7: Выведите все книги жанра "Фэнтези"
SELECT * FROM books WHERE genre = 'Фэнтези';

-- Задача 8: Найдите все книги, автор которых "Джоан Роулинг" или "Джон Р. Р. Толкин"
SELECT * FROM books WHERE author IN ('Джоан Роулинг', 'Джон Р. Р. Толкин');

-- Задача 9: Найдите все книги, цена которых от 2500 до 4000
SELECT * FROM books WHERE price BETWEEN 2500 AND 4000;

-- Задача 10: Выведите все книги, название которых содержит "Поттер"
SELECT * FROM books WHERE title LIKE '%Поттер%';

-- Задача 11: Найдите все книги, кроме детективов и ужасов
SELECT * FROM books WHERE genre NOT IN ('Детектив', 'Ужасы');

-- Задача 12: Выведите все книги, отсортированные по цене (по убыванию)
SELECT * FROM books ORDER BY price DESC;

-- Задача 13: Найдите 3 самых дорогих книг, опубликованные после 2000 года
SELECT * FROM books WHERE publication_year > 2000 ORDER BY price DESC LIMIT 3;

-- Задача 14: Найдите все книги жанра "Роман" или "Детектив", но не дороже 3500
SELECT * FROM books WHERE genre IN ('Роман', 'Детектив') AND price <= 3500;

-- Задача 15: Найдите все книги, кроме тех, которые написал "Стивен Кинг"
SELECT * FROM books WHERE author NOT IN ('Стивен Кинг');

-- Задача 16: Найдите самую дорогую книгу в жанре "Фантастика"
SELECT * FROM books WHERE genre = 'Фантастика' ORDER BY price DESC LIMIT 1;

-- Задача 17: Добавьте новую книгу "Песнь льда и огня" за авторством "Джордж Мартин" в жанре "Фэнтези", написанную в 1996 году и продающуюся за 5000
INSERT INTO books (title, author, price, genre, publication_year)
VALUES ('Песнь льда и огня', 'Джордж Мартин', 5000.00, 'Фэнтези', 1996);

-- Задача 18: Увеличьте цену книги "1984" на 10%
UPDATE books SET price = price * 1.10 WHERE title = '1984';

-- Задача 19: Измените жанр всех книг, в названии которых есть "Поттер", на "Магия"
UPDATE books SET genre = 'Магия' WHERE title LIKE '%Поттер%';

-- Задача 20: Повышение цены на 7% для всех книг, дороже 4000
UPDATE books SET price = price * 1.07 WHERE price > 4000;

-- Задача 21: Установите минимальную цену 3000 для всех книг, опубликованных после 2000 года
UPDATE books SET price = 3000 WHERE publication_year > 2000 AND price < 3000;

-- Задача 22: Измените цену книги "Гарри Поттер и философский камень" на 3500
UPDATE books SET price = 3500 WHERE title = 'Гарри Поттер и философский камень';

-- Задача 23: Измените жанр всех книг "Ужасы" на "Мистика"
UPDATE books SET genre = 'Мистика' WHERE genre = 'Ужасы';

-- Задача 24: Удалите все книги, опубликованные до 1800 года
DELETE FROM books WHERE publication_year < 1800;

-- Задача 25: Удалите все книги, написанные "Джоан Роулинг"
DELETE FROM books WHERE author = 'Джоан Роулинг';